import requests
import sys
from concurrent.futures import ThreadPoolExecutor

session = requests.Session()

def check_directory(directory):
    dir_enum = f"http://{sys.argv[1]}/{directory}.html"
    try:
        response = session.get(dir_enum, allow_redirects=True, timeout=5.0, stream=True)
        if response.ok:
            print(f"Valid directory: {response.url}")
    except requests.ConnectionError:
        pass

if __name__ == '__main__':
    with open("wordlist2.txt") as f:
        directories = (line.strip() for line in f)
        with ThreadPoolExecutor(max_workers=16) as executor:
            executor.map(check_directory, directories)
